{"openapi":"3.1.0","info":{"title":"Kids Food Advisor API (Vertex AI統合版)","description":"# Kids Food Advisor API\n    \n## 概要\nVertex AI統合による1歳半〜3歳幼児向け栄養相談システムのREST API\n\n## 主な機能\n- **栄養分析**: 科学的根拠に基づく幼児向け栄養バランス分析\n- **レシピ提案**: 年齢・アレルギーを考慮した実践的なレシピ提案\n- **画像認識**: 食事画像から食材・栄養素を自動認識\n- **ストリーミングチャット**: リアルタイムなエージェント対話\n\n## 技術スタック\n- **AI Engine**: Google Vertex AI + Gemini 2.0 Flash\n- **Framework**: FastAPI + Google ADK (Agent Development Kit)\n- **対象年齢**: 1歳半〜3歳の幼児\n    ","version":"2.0.0"},"paths":{"/api/health":{"get":{"tags":["Health"],"summary":"ヘルスチェック","description":"APIサーバーの動作状況を確認します。システム監視や負荷分散での利用を想定。","operationId":"health_check_api_health_get","responses":{"200":{"description":"正常稼働中","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse"},"example":{"success":true,"data":{"status":"healthy","timestamp":"550e8400-e29b-41d4-a716-446655440000"}}}}}}}},"/api/chat":{"post":{"tags":["Chat"],"summary":"チャットメッセージ送信","description":"Kids Food Advisorエージェントとの対話を行います。\n    \n    ## 機能\n    - 栄養相談・レシピ提案\n    - 食事バランス分析\n    - アレルギー対応アドバイス\n    \n    ## 入力例\n    - \"今日の朝食はパンとバナナでした。昼食のレシピを教えて\"\n    - \"2歳の子供に卵アレルギーがあります。おすすめの朝食は？\"","operationId":"send_chat_message_api_chat_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}},"required":true},"responses":{"200":{"description":"対話成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse"},"example":{"success":true,"data":{"id":"msg_123","message":"朝食のパンとバナナ、とても良い組み合わせですね！昼食は...","timestamp":"2024-01-15T12:00:00Z","sessionId":"session_abc"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/stream":{"post":{"tags":["Chat"],"summary":"ストリーミングチャット","description":"エージェント毎の発言分割に対応したリアルタイムチャット機能。\n    \n    ## 特徴\n    - Server-Sent Events (SSE) 形式でストリーミング配信\n    - 栄養アドバイザー・くらしアドバイザー毎の発言を分離\n    - リアルタイムな応答表示\n    \n    ## レスポンス形式\n    ```\n    data: {\"type\": \"agent_start\", \"agent_name\": \"栄養アドバイザー\"}\n    data: {\"type\": \"chunk\", \"agent_name\": \"栄養アドバイザー\", \"content\": \"朝食の...\"}\n    data: {\"type\": \"agent_complete\", \"agent_name\": \"栄養アドバイザー\", \"content\": \"完全なメッセージ\"}\n    data: {\"type\": \"stream_end\"}\n    ```","operationId":"stream_chat_message_api_chat_stream_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/image/analyze":{"post":{"tags":["Image"],"summary":"食事画像解析","description":"アップロードされた食事画像を解析して栄養情報を提供します。\n    \n    ## 解析内容\n    - 料理名・食材の特定\n    - 幼児向け適性評価\n    - 潜在アレルゲンの検出\n    - 栄養素推定\n    \n    ## サポート形式\n    - JPEG, PNG, WebP\n    - 最大ファイルサイズ: 10MB\n    \n    ## 精度向上のコツ\n    - 明るい環境での撮影\n    - 料理全体が写るようにフレーミング\n    - 複数の角度からの撮影","operationId":"analyze_food_image_api_image_analyze_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_analyze_food_image_api_image_analyze_post"}}},"required":true},"responses":{"200":{"description":"解析成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse"},"example":{"success":true,"data":{"dish_name":"野菜カレー","ingredients":["ニンジン","ジャガイモ","玉ねぎ","カレールー"],"confidence":0.85,"potential_allergens":["小麦"],"age_appropriateness":{"suitable":true,"concerns":[],"recommendations":["野菜を小さく切って食べやすくしましょう"]}}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/user/preferences":{"get":{"tags":["User"],"summary":"ユーザー設定取得","description":"現在のユーザー設定（子どもの年齢・アレルギー・食事制限等）を取得します。","operationId":"get_user_preferences_api_user_preferences_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}},"put":{"tags":["User"],"summary":"ユーザー設定更新","description":"ユーザー設定を更新します。子どもの成長に合わせて年齢や食事制限を調整できます。","operationId":"update_user_preferences_api_user_preferences_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserPreferences"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"ApiResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"data":{"anyOf":[{},{"type":"null"}],"title":"Data"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ApiResponse"},"Body_analyze_food_image_api_image_analyze_post":{"properties":{"image":{"type":"string","format":"binary","title":"Image"}},"type":"object","required":["image"],"title":"Body_analyze_food_image_api_image_analyze_post"},"ChatRequest":{"properties":{"message":{"type":"string","title":"Message"},"sessionId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sessionid"}},"type":"object","required":["message"],"title":"ChatRequest"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"UserPreferences":{"properties":{"child_age_months":{"type":"integer","title":"Child Age Months","default":24},"allergies":{"items":{"type":"string"},"type":"array","title":"Allergies","default":[]},"dietary_restrictions":{"items":{"type":"string"},"type":"array","title":"Dietary Restrictions","default":[]}},"type":"object","title":"UserPreferences"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}},"tags":[{"name":"Health","description":"システムヘルスチェック関連のエンドポイント"},{"name":"Chat","description":"チャット・対話機能（ストリーミング対応）"},{"name":"Image","description":"画像解析・食事認識機能"},{"name":"User","description":"ユーザー設定・プリファレンス管理"}]}